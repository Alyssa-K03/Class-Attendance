CREATE OR REPLACE FORCE EDITIONABLE VIEW "ATTENDANCE_COUNT_BY_DATE" ("CLASS_DATE", "ATTENDANCE_COUNT") AS 
  SELECT 
    TRUNC(CLASS_DATE) AS CLASS_DATE, 
    COUNT(STUDENT_NUMBER) AS ATTENDANCE_COUNT
FROM 
    ATTENDANCE
GROUP BY 
    TRUNC(CLASS_DATE);

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "STUDENTS_ATTENDANCE_COUNT" ("STUDENT_NUMBER", "STUDENT_FIRST_NAME", "STUDENT_LAST_NAME", "STUDENT_EMAIL", "ATTENDANCE_COUNT") AS 
  SELECT 
    s.STUDENT_NUMBER, 
    s.STUDENT_FIRST_NAME, 
    s.STUDENT_LAST_NAME, 
    s.STUDENT_EMAIL,
    COUNT(a.ATTENDANCE_ID) AS ATTENDANCE_COUNT
FROM 
    STUDENTS s
INNER JOIN 
    ATTENDANCE a 
ON 
    s.STUDENT_NUMBER = a.STUDENT_NUMBER
GROUP BY 
    s.STUDENT_NUMBER, 
    s.STUDENT_FIRST_NAME, 
    s.STUDENT_LAST_NAME, 
    s.STUDENT_EMAIL;

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "STUDENTS_NO_ATTENDANCE" ("STUDENT_NUMBER", "STUDENT_FIRST_NAME", "STUDENT_LAST_NAME", "STUDENT_EMAIL") AS 
  SELECT 
    s.STUDENT_NUMBER, 
    s.STUDENT_FIRST_NAME, 
    s.STUDENT_LAST_NAME, 
    s.STUDENT_EMAIL
FROM 
    STUDENTS s
LEFT JOIN 
    ATTENDANCE a 
ON 
    s.STUDENT_NUMBER = a.STUDENT_NUMBER
WHERE 
    a.STUDENT_NUMBER IS NULL;


  CREATE OR REPLACE FORCE EDITIONABLE VIEW "STUDENT_ATTENDANCE_DETAILS" ("STUDENT_NUMBER", "STUDENT_FIRST_NAME", "STUDENT_LAST_NAME", "STUDENT_EMAIL", "ATTENDANCE_DATE", "ATTENDANCE_TIMESTAMP") AS 
  SELECT 
    s.STUDENT_NUMBER, 
    s.STUDENT_FIRST_NAME, 
    s.STUDENT_LAST_NAME, 
    s.STUDENT_EMAIL,
    a.CLASS_DATE AS ATTENDANCE_DATE,
    a.ATTENDANCE_ID AS ATTENDANCE_TIMESTAMP
FROM 
    STUDENTS s
INNER JOIN 
    ATTENDANCE a 
ON 
    s.STUDENT_NUMBER = a.STUDENT_NUMBER;
